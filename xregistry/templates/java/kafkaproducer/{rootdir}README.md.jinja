{%- import "util.jinja.include" as util -%}
{%- set messagegroups = root.messagegroups %}
{% for messagegroupid, messagegroup in messagegroups.items() -%}
{%- set groupname = messagegroupid | pascal -%}
{%- set class_name = (groupname | strip_namespace) + "Producer" %}
# {{ project_name | pascal }} - Apache Kafka Producer

Auto-generated Java producer for Apache Kafka with partition key and header support.

## Overview

Type-safe Kafka producer for {{ groupname }} message group using Apache Kafka Clients 3.x.

## What is Apache Kafka?

**Apache Kafka** is a distributed streaming platform for high-throughput, fault-tolerant publish-subscribe messaging with persistent storage.

## Quick Start

### 1. Add Dependency

**Maven:**
```xml
<dependency>
    <groupId>{{ groupid }}</groupId>
    <artifactId>{{ project_name | snake }}</artifactId>
    <version>1.0.0</version>
</dependency>
```

### 2. Produce Messages

```java
import {{ project_name | snake }}.{{ class_name }};

Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");

{{ class_name }} producer = new {{ class_name }}(props, "my-topic");

{%- set first_message = messagegroup.messages.items() | first %}
{%- if first_message %}
{%- set messageid, message = first_message %}
{%- set messagename = messageid | pascal | strip_namespace %}
{%- set message_body_type = util.body_type(data_project_name, root, message) %}

{{ message_body_type }} data = new {{ message_body_type }}();
producer.send{{ messagename }}(data);
{%- endif %}

producer.close();
```

## Available Methods

{% for messageid, message in messagegroup.messages.items() -%}
{%- set messagename = messageid | pascal | strip_namespace %}
{%- set message_body_type = util.body_type(data_project_name, root, message) %}
### send{{ messagename }}

```java
void send{{ messagename }}({{ message_body_type }} data)
void send{{ messagename }}({{ message_body_type }} data, String key)
Future<RecordMetadata> send{{ messagename }}Async({{ message_body_type }} data)
```
{% if message.description %}
{{ message.description }}
{% endif %}

{% endfor %}

## Partition Keys

Control message ordering with keys:

```java
// All messages with same key go to same partition (ordered)
producer.sendEventName(data, "user-123");
```

## Async Sending

```java
Future<RecordMetadata> future = producer.sendEventNameAsync(data);

// With callback
producer.sendEventNameAsync(data, (metadata, exception) -> {
    if (exception == null) {
        System.out.println("Sent to partition: " + metadata.partition());
        System.out.println("Offset: " + metadata.offset());
    } else {
        System.err.println("Send failed: " + exception.getMessage());
    }
});
```

## Batch Sending

```java
List<EventData> messages = Arrays.asList(data1, data2, data3);
producer.sendEventNameBatch(messages);
```

## Authentication

### SASL/PLAIN
```java
Properties props = new Properties();
props.put("bootstrap.servers", "kafka:9093");
props.put("security.protocol", "SASL_SSL");
props.put("sasl.mechanism", "PLAIN");
props.put("sasl.jaas.config", 
    "org.apache.kafka.common.security.plain.PlainLoginModule required " +
    "username=\"user\" password=\"pass\";");

{{ class_name }} producer = new {{ class_name }}(props, "my-topic");
```

## Configuration

```java
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("acks", "all");                          // Wait for all replicas
props.put("retries", "3");                         // Retry failed sends
props.put("batch.size", "16384");                  // Batch size in bytes
props.put("linger.ms", "10");                      // Wait 10ms for batching
props.put("compression.type", "snappy");           // Compress messages

{{ class_name }} producer = new {{ class_name }}(props, "my-topic");
```

## Error Handling

```java
try {
    producer.sendEventName(data);
} catch (Exception e) {
    System.err.println("Send failed: " + e.getMessage());
}
```

## Learn More

- [Apache Kafka Documentation](https://kafka.apache.org/documentation/)
- [xRegistry CLI Documentation](https://github.com/clemensv/xregistry-cli)

## Generated Code

Auto-generated by [xRegistry CLI](https://github.com/clemensv/xregistry-cli).
{% endfor %}
