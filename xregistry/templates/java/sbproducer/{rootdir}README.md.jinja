{%- import "util.jinja.include" as util -%}
{%- set messagegroups = root.messagegroups %}
{% for messagegroupid, messagegroup in messagegroups.items() -%}
{%- set groupname = messagegroupid | pascal -%}
{%- set class_name = (groupname | strip_namespace) + "Producer" %}
# {{ project_name | pascal }} - Azure Service Bus Producer

Auto-generated Java producer for Azure Service Bus with advanced message scheduling and sessions.

## Overview

Type-safe producer for {{ groupname }} message group using Azure Service Bus Java SDK 7.x.

## What is Azure Service Bus?

**Azure Service Bus** is a fully managed enterprise message broker with reliable delivery, transactions, and advanced features like message scheduling and duplicate detection.

## Quick Start

### 1. Add Dependency

**Maven:**
```xml
<dependency>
    <groupId>{{ groupid }}</groupId>
    <artifactId>{{ project_name | snake }}</artifactId>
    <version>1.0.0</version>
</dependency>
```

### 2. Send Messages

```java
import {{ project_name | snake }}.{{ class_name }};

String connectionString = "Endpoint=sb://namespace.servicebus.windows.net/;...";
String queueName = "my-queue";

{{ class_name }} producer = new {{ class_name }}(connectionString, queueName);

{%- set first_message = messagegroup.messages.items() | first %}
{%- if first_message %}
{%- set messageid, message = first_message %}
{%- set messagename = messageid | pascal | strip_namespace %}
{%- set message_body_type = util.body_type(data_project_name, root, message) %}

{{ message_body_type }} data = new {{ message_body_type }}();
producer.send{{ messagename }}(data);
{%- endif %}

producer.close();
```

## Available Methods

{% for messageid, message in messagegroup.messages.items() -%}
{%- set messagename = messageid | pascal | strip_namespace %}
{%- set message_body_type = util.body_type(data_project_name, root, message) %}
### send{{ messagename }}

```java
void send{{ messagename }}({{ message_body_type }} data)
void send{{ messagename }}({{ message_body_type }} data, SendOptions options)
CompletableFuture<Void> send{{ messagename }}Async({{ message_body_type }} data)
```
{% if message.description %}
{{ message.description }}
{% endif %}

{% endfor %}

## Scheduled Messages

Send messages for future delivery:

```java
SendOptions options = new SendOptions();
options.setScheduledEnqueueTime(OffsetDateTime.now().plusHours(2));  // Deliver in 2 hours

producer.sendEventName(data, options);
```

## Sessions (Ordered Delivery)

Guarantee message order within a session:

```java
SendOptions options = new SendOptions();
options.setSessionId("user-123");  // All messages with same sessionId delivered in order

producer.sendEventName(data, options);
```

## Message Properties

```java
SendOptions options = new SendOptions();
options.setMessageId("unique-id");
options.setCorrelationId("correlation-id");
options.setTimeToLive(Duration.ofMinutes(30));
options.addApplicationProperty("priority", "high");

producer.sendEventName(data, options);
```

## Duplicate Detection

Prevent duplicate messages:

```java
SendOptions options = new SendOptions();
options.setMessageId("unique-id-12345");  // Duplicates within detection window discarded

producer.sendEventName(data, options);
```

## Batch Sending

```java
List<EventData> messages = Arrays.asList(data1, data2, data3);
producer.sendEventNameBatch(messages);
```

## Authentication

### Azure AD (Recommended)
```java
{{ class_name }} producer = {{ class_name }}.builder()
    .fullyQualifiedNamespace("mybus.servicebus.windows.net")
    .queueName(queueName)
    .credential(new DefaultAzureCredentialBuilder().build())
    .build();
```

### Connection String
```java
{{ class_name }} producer = new {{ class_name }}(connectionString, queueName);
```

## Error Handling

```java
try {
    producer.sendEventName(data);
} catch (ServiceBusException e) {
    System.err.println("Send failed: " + e.getMessage());
}
```

## Learn More

- [Azure Service Bus Documentation](https://learn.microsoft.com/azure/service-bus-messaging/)
- [xRegistry CLI Documentation](https://github.com/clemensv/xregistry-cli)

## Generated Code

Auto-generated by [xRegistry CLI](https://github.com/clemensv/xregistry-cli).
{% endfor %}
